# 碳循环饮食计算器 - 开发计划

本文档根据产品需求文档（PRD）制定，旨在将项目分解为可执行的开发任务，并规划开发流程。

## 1. 里程碑规划

我们将项目分为三个主要里程碑，以确保核心功能优先交付，并逐步完善用户体验和高级功能。

### Milestone 1: v0.1 - MVP 核心功能实现

**目标**: 完成计算器的核心逻辑和基本交互，用户可以输入信息并获得准确的饮食计划。

### Milestone 2: v0.2 - 视觉与体验增强

**目标**: 实现动态背景、玻璃拟态卡片、主题切换等视觉效果，并优化响应式布局和用户交互。

### Milestone 3: v0.3 - 国际化与高级功能

**目标**: 实现多语言支持、单位切换功能，并完成图片导出、本地存储等高级功能。

---

## 2. 任务分解 (Task Breakdown)

### Milestone 1: v0.1 - MVP 核心功能实现

| 优先级 | 任务                       | 描述                                                                    | 关联 PRD 章节 |
| :----- | :------------------------- | :---------------------------------------------------------------------- | :------------ |
| **P0** | **项目初始化与技术栈搭建** | 使用 Vite + React + TypeScript 初始化项目，并集成 shadcn/ui。           | 2             |
| **P0** | **核心计算逻辑实现**       | 在 `src/lib` 或 `src/utils` 中创建计算函数，实现 PRD 中的所有计算逻辑。 | 9.2           |
| **P0** | **输入表单组件开发**       | 创建 `InputForm` 组件，包含体重、体型、蛋白系数、循环天数等输入控件。   | 9.1           |
| **P1** | **结果展示组件开发**       | 创建 `ResultCard` 组件，包含周度摘要和每日明细表。                      | 10            |
| **P1** | **表单验证**               | 使用 `react-hook-form` + `zod` 实现表单校验和错误提示。                 | 11            |
| **P2** | **基础布局与响应式设计**   | 实现桌面端左右布局和移动端垂直布局。                                    | 6             |
| **P2** | **Footer 免责声明**        | 添加固定的页脚，包含免责声明和公式来源。                                | 12            |

### Milestone 2: v0.2 - 视觉与体验增强

| 优先级 | 任务                 | 描述                                                                                  | 关联 PRD 章节 |
| :----- | :------------------- | :------------------------------------------------------------------------------------ | :------------ |
| **P0** | **主题切换功能**     | 实现 `light/dark/system` 主题切换，并使用 `localStorage` 持久化。                     | 3             |
| **P1** | **动态粒子背景**     | 集成 `react-tsparticles`，实现随主题变化的动态背景，并处理 `prefers-reduced-motion`。 | 4             |
| **P1** | **玻璃拟态卡片样式** | 为输入和结果卡片添加 Glassmorphism 效果。                                             | 5             |
| **P2** | **结果复制到剪贴板** | 实现一键复制 Markdown 格式的饮食计划。                                                | 10            |
| **P2** | **Empty State 优化** | 在结果区域未就绪时，显示友好的空状态提示。                                            | 6             |

### Milestone 3: v0.3 - 国际化与高级功能

| 优先级 | 任务                       | 描述                                                                         | 关联 PRD 章节 |
| :----- | :------------------------- | :--------------------------------------------------------------------------- | :------------ |
| **P0** | **国际化 (i18n) 框架集成** | 集成 i18next 或类似库，实现 `zh-CN` / `en` 语言切换，并持久化选择。          | 7             |
| **P1** | **单位系统切换 (kg/lbs)**  | 实现公制/英制单位切换，并确保计算和显示的正确性。                            | 8             |
| **P1** | **结果导出为图片**         | 使用 `html-to-image` 或类似库，将结果卡片导出为 PNG 图片，并处理兼容性问题。 | 10            |
| **P2** | **本地存储用户输入**       | (可选增强) 使用 `localStorage` 保存用户上一次的输入，提升用户体验。          | 15            |
| **P3** | **优化与测试**             | 全面测试性能、可访问性和浏览器兼容性，修复 Bug。                             | 13, 14        |

---

## 3. 技术选型确认

- **脚手架**: Vite
- **框架**: React 19+
- **语言**: TypeScript
- **UI 组件库**: shadcn/ui
- **表单管理**: react-hook-form
- **校验**: zod
- **动态背景**: react-tsparticles
- **国际化**: i18next
- **图片导出**: html-to-image

---

## 4. 组件设计 (初步)

```
src/
├── components/
│   ├── ui/ (来自 shadcn/ui)
│   ├── layout/
│   │   ├── Header.tsx
│   │   ├── Footer.tsx
│   │   └── ThemeProvider.tsx
│   ├── core/
│   │   ├── InputForm.tsx         # 输入表单
│   │   ├── ResultCard.tsx        # 结果展示
│   │   ├── Summary.tsx           # 周度摘要
│   │   └── DailyTable.tsx        # 每日明细表
│   └── shared/
│       ├── ParticleBackground.tsx # 粒子背景
│       └── LanguageSwitcher.tsx   # 语言切换器
├── lib/
│   ├── calculator.ts             # 核心计算逻辑
│   ├── i18n.ts                   # 国际化配置
│   └── utils.ts                  # 工具函数
└── App.tsx                       # 应用主入口
```
